<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- SNS Link -->
                {% include sns-links.html center=true %}
                <p class="copyright text-muted">
                    Copyright &copy; {{ site.title }} {{ site.time | date: '%Y' }}
                    <br>
                    Powered by <a href="http://markleighedu.github.io/">Mark Leigh Blog</a>
                     <br>
                   ðŸ“Š Disclaimer: All content on this site is for educational and informational purposes only and does not constitute financial or investment advice. By using any content here, you acknowledge that you understand the risks involved in trading and agree that no one, including the site owner, is liable for any of your financial decisions or outcomes.
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="{{ "/js/jquery.min.js" | prepend: site.baseurl }}"></script>

<!-- Bootstrap Core JavaScript -->
<script src="{{ "/js/bootstrap.min.js" | prepend: site.baseurl }}"></script>

<!-- Custom Theme JavaScript -->
<script src="{{ "/js/mark-blog.min.js" | prepend: site.baseurl }}"></script>

<!-- Simple Jekyll Search -->
<script src="{{ "/js/simple-jekyll-search.min.js" | prepend: site.baseurl }}"></script>

<!-- Service Worker -->
{% if site.service-worker %}
<script src="{{ "/js/snackbar.js" | prepend: site.baseurl }}"></script>
<script src="{{ "/js/sw-registration.js" | prepend: site.baseurl }}"></script>
{% endif %}

<!-- Async load function -->
<script>
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }
</script>

{% if page.plchart %}
<script>
    function resizeIframe(obj) {
        obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px';
    }

    $(document).ready(function () {
        var $chart = document.querySelector("#chart");
        $chart.onload = function () {
            resizeIframe($chart)
        }
        window.addEventListener("resize", () => {
            resizeIframe($chart)
        });
    })
</script>
{% endif %}

{% if page.title == 'Archive' %}
<script>
    async('{{ "/js/jquery.tagcloud.js" | prepend: site.baseurl }}', function () {
        $.fn.tagcloud.defaults = {
            color: { start: '#bbbbee', end: '#2f93b4' },
        };
        $('#tag_cloud a').tagcloud();
    })
</script>
<script src='{{ "/js/archive.js" | prepend: site.baseurl }}'></script>
{% endif %}

<!-- Google Analytics -->
{% if site.ga_track_id %}
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; 
        i[r] = i[r] || function () { (i[r].q = i[r].q || []).push(arguments) }, 
        i[r].l = 1 * new Date(); 
        a = s.createElement(o), m = s.getElementsByTagName(o)[0]; 
        a.async = 1; a.src = g; 
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', '{{ site.ga_track_id }}', '{{ site.ga_domain }}');
    ga('send', 'pageview');
</script>
{% endif %}

<!-- Baidu Tongji -->
{% if site.ba_track_id %}
<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?" + '{{ site.ba_track_id }}';
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
{% endif %}

<!-- Side Catalog -->
{% unless page.no-catalog %}
<script type="text/javascript">
    function generateCatalog(selector) {
        var P = $('div.post-container'), a, n, t, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');
        $(selector).html('')
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
    }

    generateCatalog(".catalog-body");

    $(".catalog-toggle").click(function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    });

    async("{{ '/js/jquery.nav.js' | prepend: site.baseurl }}", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            scrollSpeed: 700,
            scrollThreshold: .2,
            padding: 80
        });
    });
</script>
{% endunless %}

<!-- Multi-Lingual -->
{% if page.multilingual %}
<script type="text/javascript">
    var $zh = document.querySelector(".zh");
    var $en = document.querySelector(".en");

    function getLang() { return new URLSearchParams(document.location.search).get("lang") }

    function setLang(newLang) {
        var params = new URLSearchParams(document.location.search)
        params.set("lang", newLang)
        document.location.search = params.toString();
    }

    function _render() {
        var lang = getLang()
        if (lang == "en") {
            $en.style.display = "block";
            $en.classList.add("active");
            $zh.style.display = "none";
            $zh.classList.remove("active");
        } else {
            $zh.style.display = "block";
            $zh.classList.add("active");
            $en.style.display = "none";
            $en.classList.remove("active");
        }
        generateCatalog(".catalog-body");
    }

    _render();
</script>
{% endif %}

<!-- Simple Jekyll Search -->
<script>
    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('search-results'),
        json: '/search.json',
        searchResultTemplate: '<div class="post-preview item"><a href="{url}"><h2 class="post-title">{title}</h2><h3 class="post-subtitle">{subtitle}</h3><hr></a></div>',
        noResultsText: 'No results',
        limit: 50,
        fuzzy: false
    });

    $(document).ready(function () {
        var $searchPage = $('.search-page');
        var $searchOpen = $('.search-icon');
        var $searchClose = $('.search-icon-close');
        var $searchInput = $('#search-input');
        var $body = $('body');

        $searchOpen.on('click', function (e) {
            e.preventDefault();
            $searchPage.toggleClass('search-active');
            $body.addClass('no-scroll');
            if ($searchPage.hasClass('search-active')) {
                $searchClose.on('click', function (e) {
                    e.preventDefault();
                    $searchPage.removeClass('search-active');
                    $body.removeClass('no-scroll');
                });
                $searchInput.focus();
            }
        });
    });
</script>
