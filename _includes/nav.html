<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top {% if page.nav-style == "invert" or page.header-style == "text" %}invert{% endif %}">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="{{ site.baseurl }}/">{{ site.title }}</a>
        </div>

        <!-- Navbar links -->
        <div id="markblog_navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="{{ '/' | relative_url }}">Home</a>
                </li>
                {% for page in site.pages %}
                {% assign lang_prefix = '/es/' %}
                {% if page.url contains '/zh-cn/' %}
                    {% assign lang_prefix = '/zh-cn/' %}
                {% elsif page.url contains '/es/' %}
                    {% assign lang_prefix = '/es/' %}
                {% else %}
                    {% assign lang_prefix = '' %}
                {% endif %}
                {% if page.title and page.hide-in-nav != true and page.url contains lang_prefix %}
                <li>
                    <a href="{{ page.url | relative_url }}">{{ page.nav-title | default: page.title }}</a>
                </li>
                {% endif %}
                {% endfor %}
                <li class="languages-icon">
                    <a href="javascript:void(0)" id="language-toggle">
                        <i class="fa fa-globe fa-2x"></i>
                        <span class="language-label">
                            {% if page.url contains '/es/' %}
                            Español
                            {% elsif page.url contains '/zh-cn/' %}
                            简体中文
                            {% else %}
                            English
                            {% endif %}
                        </span>
                    </a>
                    <!-- Language Dropdown Menu -->
                    <ul id="language-menu" class="language-dropdown hidden">
                        {% if page.url contains '/es/' %}
                        <li><a href="/zh-cn/index.html">简体中文</a></li>
                        <li><a href="/">English</a></li>
                        {% elsif page.url contains '/zh-cn/' %}
                        <li><a href="/es">Español</a></li>
                        <li><a href="/">English</a></li>
                        {% else %}
                        <li><a href="/es">Español</a></li>
                        <li><a href="/zh-cn">简体中文</a></li>
                        {% endif %}
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const toggle = document.querySelector('.navbar-toggle');
        const navbar = document.getElementById('markblog_navbar');
        const languageToggle = document.getElementById('language-toggle');
        const languageMenu = document.getElementById('language-menu');

        // Navbar toggle behavior
        toggle.addEventListener('click', function () {
            const isExpanded = navbar.classList.contains('in');
            navbar.classList.toggle('in', !isExpanded);
        });

        // Language menu toggle behavior
        languageToggle.addEventListener('click', function (e) {
            e.stopPropagation();
            languageMenu.classList.toggle('hidden');
        });

        // Close language menu when clicking outside
        document.addEventListener('click', function () {
            languageMenu.classList.add('hidden');
        });
    });
</script>

<style>
    .language-dropdown {
        display: none;
        position: absolute;
        background: white;
        list-style: none;
        padding: 10px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .language-dropdown.hidden {
        display: none;
    }

    .language-dropdown li {
        margin: 5px 0;
    }
</style>
